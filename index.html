<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Kuli-Bakso Configurator</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<style>
body { font-family:'Poppins',sans-serif; margin:0; background:#121212; color:#f5f5f5; }
header { background:#e63946; color:white; padding:20px; text-align:center; }
.container { max-width:900px; margin:30px auto; background:#1e1e1e; padding:30px; border-radius:20px; box-shadow:0 0 30px rgba(230,57,70,0.5); }
h2 { color:#2a9d8f; }
select { width:100%; padding:12px; margin:10px 0; border-radius:12px; border:1px solid #e63946; background:#2a2a2a; color:#fff; }
select:hover { box-shadow:0 0 15px #e63946; transform:scale(1.05); }
.preview { background:#2a2a2a; padding:20px; border-radius:12px; margin-top:20px; }
button { background:#e63946; color:white; border:none; padding:15px; border-radius:12px; width:100%; font-size:16px; cursor:pointer; margin-top:10px; }
button:hover { box-shadow:0 0 20px #e63946; transform:scale(1.05); }
.price { font-size:22px; font-weight:bold; color:#2a9d8f; margin-top:15px; text-shadow:0 0 10px #2a9d8f; }
.qr-box { text-align:center; margin-top:20px; }
.secret { margin-top:15px; padding:15px; border-radius:12px; background:#2a9d8f; color:#121212; font-weight:bold; display:none; }
</style>
</head>
<body>

<header>
  <h1>Kuli-Bakso</h1>
  <p>Rakit Bakso Sesuai Selera Kamu üç≤</p>
</header>

<div class="container" id="configPage">

  <!-- TEMPLATE -->
  <h2>Template Bakso (Pilih Salah Satu)</h2>
  <select id="template" onchange="applyTemplate()">
    <option value="none">-- Pilih Template --</option>
    <option value="classic">Classic Bakso Sapi</option>
    <option value="spicy">Spicy Tom Yum</option>
    <option value="cheesy">Cheesy Mozzarella</option>
    <option value="healthy">Healthy Green</option>
  </select>

  <h2>1. Pilih Isi Bakso</h2>
  <select id="isi">
    <option value="Daging Sapi" data-price="15000">Daging Sapi (+15k)</option>
    <option value="Ayam" data-price="12000">Ayam (+12k)</option>
    <option value="Ikan" data-price="13000">Ikan (+13k)</option>
    <option value="Udang" data-price="18000">Udang (+18k)</option>
    <option value="Mozzarella" data-price="20000">Keju Mozzarella (+20k)</option>
    <option value="Smoked Cheese" data-price="22000">Smoked Cheese (+22k)</option>
  </select>

  <h2>2. Pilih Tepung</h2>
  <select id="tepung">
    <option value="Kanji" data-price="0">Kanji (Gratis)</option>
    <option value="Terigu" data-price="2000">Terigu (+2k)</option>
    <option value="Singkong" data-price="3000">Singkong (+3k)</option>
    <option value="Oat" data-price="5000">Oat (+5k)</option>
  </select>

  <h2>3. Pilih Kuah</h2>
  <select id="kuah">
    <option value="Kaldu Sapi" data-price="0">Kaldu Sapi (Gratis)</option>
    <option value="Tom Yum" data-price="5000">Tom Yum (+5k)</option>
    <option value="Miso Jepang" data-price="7000">Miso Jepang (+7k)</option>
    <option value="Sichuan" data-price="7000">Sichuan Pedas (+7k)</option>
    <option value="Herbal" data-price="4000">Herbal Bening (+4k)</option>
  </select>

  <h2>4. Pilih Mie</h2>
  <select id="mie">
    <option value="Mie Kuning" data-price="0">Mie Kuning (Gratis)</option>
    <option value="Bihun" data-price="2000">Bihun (+2k)</option>
    <option value="Kwetiau" data-price="3000">Kwetiau (+3k)</option>
    <option value="Ramen" data-price="5000">Ramen (+5k)</option>
    <option value="Shirataki" data-price="7000">Shirataki (+7k)</option>
    <option value="Mie Bayam" data-price="4000">Mie Hijau Bayam (+4k)</option>
  </select>

  <h2>5. Pilih Topping</h2>
  <select id="topping" multiple size="7">
    <option value="Siomay Goreng" data-price="5000">Siomay Goreng (+5k)</option>
    <option value="Dimsum Keju" data-price="7000">Dimsum Keju (+7k)</option>
    <option value="Udang Keju" data-price="8000">Udang Keju (+8k)</option>
    <option value="Spring Roll" data-price="6000">Spring Roll (+6k)</option>
    <option value="Pangsit" data-price="4000">Pangsit (+4k)</option>
    <option value="Jamur Crispy" data-price="5000">Jamur Crispy (+5k)</option>
    <option value="Telur Rebus" data-price="3000">Telur Rebus (+3k)</option>
  </select>

  <div class="preview" id="preview"></div>
  <div class="price" id="totalPrice">Total: IDR 0</div>

  <button onclick="goToPayment()">Lanjut ke Payment</button>
</div>

<div class="container" id="paymentPage" style="display:none;">
  <h2>Halaman Pembayaran</h2>

  <div class="preview" id="resultPreview"></div>
  <div class="price" id="resultPrice"></div>

  <div class="preview">
    <strong id="uniqueScore">Uniqueness: 0 / 100</strong>
  </div>

  <div class="secret" id="secretIngredient">
    üéâ Kamu mendapatkan <strong>Secret Ingredient GRATIS</strong>!
  </div>

  <p>Silakan pilih metode pembayaran:</p>
  <button onclick="generateCashQR()">Bayar via Tunai (QR)</button>
  <button disabled style="background:#555;">QRIS (Coming Soon)</button>
  <div class="qr-box" id="qrBox"></div>
</div>

<script src="https://cdn.jsdelivr.net/npm/qrcode/build/qrcode.min.js"></script>
<script>
function updatePreview(){
  let total = 0;
  const isi = document.getElementById("isi");
  total += parseInt(isi.selectedOptions[0].dataset.price);
  const tepung = document.getElementById("tepung");
  total += parseInt(tepung.selectedOptions[0].dataset.price);
  const kuah = document.getElementById("kuah");
  total += parseInt(kuah.selectedOptions[0].dataset.price);
  const mie = document.getElementById("mie");
  total += parseInt(mie.selectedOptions[0].dataset.price);
  const topping = Array.from(document.getElementById("topping").selectedOptions);
  topping.forEach(opt => total += parseInt(opt.dataset.price));

  const preview = `
    <strong>Pesanan:</strong><br>
    Isi: ${isi.value}<br>
    Tepung: ${tepung.value}<br>
    Kuah: ${kuah.value}<br>
    Mie: ${mie.value}<br>
    Topping: ${topping.map(o=>o.value).join(", ") || "Tanpa topping"}
  `;
  document.getElementById("preview").innerHTML = preview;
  document.getElementById("totalPrice").innerText = "Total: IDR " + total.toLocaleString();
}

// jalankan updatePreview setiap kali ada perubahan
document.querySelectorAll("select").forEach(sel => sel.addEventListener("change", updatePreview));
updatePreview();

function applyTemplate(){
  const template = document.getElementById("template").value;

  if(template === "classic"){
    document.getElementById("isi").value = "Daging Sapi";
    document.getElementById("tepung").value = "Kanji";
    document.getElementById("kuah").value = "Kaldu Sapi";
    document.getElementById("mie").value = "Mie Kuning";
  } else if(template === "spicy"){
    document.getElementById("isi").value = "Udang";
    document.getElementById("tepung").value = "Terigu";
    document.getElementById("kuah").value = "Tom Yum";
    document.getElementById("mie").value = "Ramen";
  } else if(template === "cheesy"){
    document.getElementById("isi").value = "Mozzarella";
    document.getElementById("tepung").value = "Singkong";
    document.getElementById("kuah").value = "Miso Jepang";
    document.getElementById("mie").value = "Mie Kuning";
  } else if(template === "healthy"){
    document.getElementById("isi").value = "Ikan";
    document.getElementById("tepung").value = "Oat";
    document.getElementById("kuah").value = "Herbal";
    document.getElementById("mie").value = "Mie Bayam";
  }

  updatePreview();
}

function goToPayment(){
  document.getElementById("configPage").style.display="none";
  document.getElementById("paymentPage").style.display="block";

  const isi = document.getElementById("isi");
  const tepung = document.getElementById("tepung");
  const kuah = document.getElementById("kuah");
  const mie = document.getElementById("mie");
  const topping = Array.from(document.getElementById("topping").selectedOptions);

  const total = parseInt(isi.selectedOptions[0].dataset.price)
              + parseInt(tepung.selectedOptions[0].dataset.price)
              + parseInt(kuah.selectedOptions[0].dataset.price)
              + parseInt(mie.selectedOptions[0].dataset.price)
              + topping.reduce((sum, opt)=> sum + parseInt(opt.dataset.price), 0);

  const resultPreview = `
    <strong>Pesanan:</strong><br>
    Isi: ${isi.value}<br>
    Tepung: ${tepung.value}<br>
    Kuah: ${kuah.value}<br>
    Mie: ${mie.value}<br>
    Topping: ${topping.map(o=>o.value).join(", ") || "Tanpa topping"}
  `;
  document.getElementById("resultPreview").innerHTML = resultPreview;
  document.getElementById("resultPrice").innerText = "Total: IDR " + total.toLocaleString();

  const uniqueScore = calculateUniqueness(isi.value, tepung.value, kuah.value, mie.value, topping);
  document.getElementById("uniqueScore").innerText = "Uniqueness: " + uniqueScore + " / 100";

  if(uniqueScore > 50){
    document.getElementById("secretIngredient").style.display = "block";
  } else {
    document.getElementById("secretIngredient").style.display = "none";
  }
}

function calculateUniqueness(isi, tepung, kuah, mie, topping){
  let score = 0;
  const weights = {
    "Daging Sapi": 20,
    "Ayam": 15,
    "Ikan": 18,
    "Udang": 25,
    "Mozzarella": 30,
    "Smoked Cheese": 35,
    "Kanji": 5,
    "Terigu": 10,
    "Singkong": 15,
    "Oat": 20,
    "Kaldu Sapi": 5,
    "Tom Yum": 20,
    "Miso Jepang": 25,
    "Sichuan": 30,
    "Herbal": 15,
    "Mie Kuning": 5,
    "Bihun": 10,
    "Kwetiau": 15,
    "Ramen": 20,
    "Shirataki": 25,
    "Mie Bayam": 18
  };

  score += weights[isi] || 0;
  score += weights[tepung] || 0;
  score += weights[kuah] || 0;
  score += weights[mie] || 0;
  topping.forEach(opt => score += (weights[opt.value] || 5));

  score = Math.min(100, Math.round(score / 2));
  return score;
}

function generateCashQR(){
  const qrBox = document.getElementById("qrBox");
  qrBox.innerHTML = "";
  const total = document.getElementById("resultPrice").innerText;
  const order = document.getElementById("resultPreview").innerText;
  const text = `Pesanan Kuli-Bakso\n${order}\n${total}\nBayar di Counter`;
  QRCode.toCanvas(text, {width:200}, function(err, canvas){
    if(err) console.error(err);
    qrBox.appendChild(canvas);
  });
}
</script>

</body>
</html>
